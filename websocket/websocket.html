<!DOCTYPE html>
<html>

<head>
    <title>WebSocket 测试</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <!-- <script src="websocket-sockjs.js"></script> -->
    <!-- <script src="websocket-stomp.js"></script> -->
    <script src="stomp.js"></script>
</head>

<body>
    <p>接收到消息：</p>
    <div id="message"></div>
    <script>
        var socket = new WebSocket("ws://localhost:8000/stomp/test");
        var stompClient = Stomp.over(socket);
        stompClient.connect({}, function (frame) {
            console.log("连接成功", frame);

            console.log("向/web-socket/stomp/test", "Hello,STOMP")
            stompClient.send("/web-socket/stomp/side", {}, "Hello,STOMP");

            console.log("向/web-socket/stomp/ant/abc", "Hello,ant")
            stompClient.send("/web-socket/stomp/ant/abc", {}, "Hello,ant");

            console.log("订阅topic", "/topic")
            var subscription = stompClient.subscribe("/topic", function (message) {
                // called every time the client receives a message
                console.log("stomp接收到topic推送的消息：", message);
            });
            console.log(subscription);
            // console.log("取消订阅！")
            // subscription.unsubscribe();
        }, function (error) {
            // display the error's message header:
            alert("订阅失败", error);
        });


    </script>
</body>

</html>